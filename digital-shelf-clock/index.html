<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

    <title>Digital Shelf Clock</title>
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans:300,400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic" rel="stylesheet" type="text/css">
    <link href="/assets/css/style.min.css"  rel="stylesheet" type="text/css">
    <link href="../favicon.png" rel="shortcut icon">
    <meta name="description" content="Here&#x27;s a clock that feels like its built into the shelf itself. When the clock is turned off, it is an ordinary shelf on the wall." />
    <link rel="shortcut icon" href="../favicon.png" type="image/png" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/" />
    
    <meta property="og:site_name" content="RBKlabs" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Digital Shelf Clock" />
    <meta property="og:description" content="Here&#x27;s a clock that feels like its built into the shelf itself. When the clock is turned off, it is an ordinary shelf on the wall." />
    <meta property="og:url" content="https://rbklabs.in/digital-shelf-clock/" />
    <meta property="og:image" content="https://rbklabs.in/content/images/2020/08/IMG_20200809_121541.jpg" />
    <meta property="article:published_time" content="2020-08-08T15:31:11.000Z" />
    <meta property="article:modified_time" content="2020-08-09T13:59:23.000Z" />
    <meta property="article:tag" content="Electronics" />
    <meta property="article:tag" content="3D" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Digital Shelf Clock" />
    <meta name="twitter:description" content="Here&#x27;s a clock that feels like its built into the shelf itself. When the clock is turned off, it is an ordinary shelf on the wall." />
    <meta name="twitter:url" content="https://rbklabs.in/digital-shelf-clock/" />
    <meta name="twitter:image" content="https://rbklabs.in/content/images/2020/08/IMG_20200809_121541.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Rakshith BK" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Electronics, 3D" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1500" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "RBKlabs",
        "url": "https://rbklabs.in/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://rbklabs.in/content/images/2020/05/no_bg_xtra_large.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Rakshith BK",
        "image": {
            "@type": "ImageObject",
            "url": "https://rbklabs.in/content/images/2020/05/profile_photo_rbklabs.jpeg",
            "width": 901,
            "height": 907
        },
        "url": "https://rbklabs.in/author/rakshith/",
        "sameAs": [
            "https://github.com/rakshithbk"
        ]
    },
    "headline": "Digital Shelf Clock",
    "url": "https://rbklabs.in/digital-shelf-clock/",
    "datePublished": "2020-08-08T15:31:11.000Z",
    "dateModified": "2020-08-09T13:59:23.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://rbklabs.in/content/images/2020/08/IMG_20200809_121541.jpg",
        "width": 2000,
        "height": 1500
    },
    "keywords": "Electronics, 3D",
    "description": "\n\nHere&#x27;s a clock that feels like its built into the shelf itself. When the clock\nis turned off, it is an ordinary shelf on the wall. But when the digits start to\nshow up, I like the reaction from people seeing it for first time 😊.\n\n\n\n\n--------------------------------------------------------------------------------\n\nCarpentry\n\n\nShelf and compartments made as part of furniture work.\n\nThe dimensions for each compartment is 5&quot; x 5&quot;. This is from mid point of the\nply wood to mid point of the next on",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://rbklabs.in/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.18" />
    <link rel="alternate" type="application/rss+xml" title="RBKlabs" href="../rss/index.rss" />
</head>
<body class="post-template tag-electronics tag-3d">
    <header id="header" class="header cover-image animated fadeIn" style="background-image: url(../content/images/size/w2000/2020/08/IMG_20200809_121541.jpg)">
        <section class="header--top">
            <div>
    <a class="blog-title " href="../">
            <img class="blog-logo" src="../content/images/2020/05/no_bg_xtra_large.png" alt="Blog Logo" />
    </a>
    
</div>
<nav class="blog-navigation">
    <ul>
        <!-- Loop through the navigation items -->
            <li class="nav-home"><a href="../"><span class="label">Home</span></a></li>
            <li class="nav-tag"><a href="../my-tags/"><span class="label">Tag</span></a></li>
            <li class="nav-author"><a href="../author/rakshith/"><span class="label">Author</span></a></li>
        <!-- End the loop -->
    </ul>
</nav>        </section>
        <section class="hero post-meta">
            <div class="hero-content">
                <h1 class="post-title animated fadeInUp delay-1">Digital Shelf Clock</h1>
                <div class="post-data">
                    <p class="date animated fadeInUp delay-2">Posted by <span class="author"><a href="../author/rakshith/">Rakshith BK</a></span> <a href="index.html"><time class="timesince" datetime="2020-08-08T21:01" title="2020-08-08 21:01">16 days ago</time></a></p>
                    <p class="post--read-time animated fadeInUp delay-3">4 min read</p>
                        <p class="post--tags animated fadeInUp delay-4"> <a href="../tag/electronics/">Electronics</a> <a href="../tag/3d/">3D</a></p>
                </div>
            </div>
        </section>
    </header>
    <main id="main" class="main">
        <article class="animated fadeIn delay-5 post tag-electronics tag-3d">
            <section class="content">
                <p></p><p>Here's a clock that feels like its built into the shelf itself. When the clock is turned off, it is an ordinary shelf on the wall. But when the digits start to show up, I like the reaction from people seeing it for first time 😊.</p><figure class="kg-card kg-gallery-card kg-width-wide"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="../content/images/2020/08/IMG_20200804_220144.jpg" width="4608" height="3456"></div></div></div></figure><p></p><hr><h3 id="carpentry">Carpentry</h3><p></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="../content/images/2020/08/IMG_20200617_192428.jpg" class="kg-image"><figcaption>Shelf and compartments made as part of furniture work.</figcaption></figure><p></p><p>The dimensions for each compartment is 5" x 5". This is from mid point of the ply wood to mid point of the next one.<br>So the total height of the shelf will be 5" + 5" + 6mm + 6mm  = 10.5"<br>And the length the came up to be 40". (and hence the size diff that we can see in the 3D printing section).</p><hr><h3 id="designing-the-shelf-edge-for-digits">Designing the Shelf Edge for Digits</h3><p></p><p>The Edges of the shelf will act as the individual segments of the digits (if you can imagine the digit in a 7 segment display). So each box/compartment should have a separate edge enclosure to reflect this.</p><!--kg-card-begin: html--><figure class="kg-card kg-embed-card"><iframe width="560" height="315" src="https://www.youtube.com/embed/J_1IpLSZ13A?autoplay=1&controls=1&loop=1&mute=1&playlist=J_1IpLSZ13A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><!--kg-card-end: html--><p></p><p>Next the space between two such edges needs a filler to make everything look flush to the surface. And give an impression of an ordinary shelf. A small triangle is designed to fit this gap.</p><!--kg-card-begin: html--><figure class="kg-card kg-embed-card"><iframe width="560" height="315" src="https://www.youtube.com/embed/rCPD7eG80tA?autoplay=1&controls=1&loop=1&mute=1&playlist=rCPD7eG80tA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><!--kg-card-end: html--><p></p><hr><h3 id="3d-printing-all-the-parts">3D printing all the parts</h3><p></p><p>The shelf needs total of 42 edge pieces and 24 triangle fillers to be printed.<br>But it those 42 edges some of them had to be smaller in order to adjust for the imperfections in the wood cutting and making of the shelf itself. I printed some 3mm lesser in length as and when the regular ones didn't fit.<br></p><p>Each Edge takes approx 1hr to print with 0.2 mm layer height. So thats 42 hours of printing just for these guys. I printed these over the week, in batches of 4 and some time between batch for the printer to get some rest 😅.<br>The filler triangle pieces have a fairly faster print time.</p><p></p><!--kg-card-begin: html--><figure class="kg-card kg-embed-card"><iframe width="560" height="315" src="https://www.youtube.com/embed/V08A2VyDrgk?autoplay=0&controls=1&loop=1&mute=1&playlist=V08A2VyDrgk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><!--kg-card-end: html--><p></p><!--kg-card-begin: html--><figure class="kg-card kg-embed-card"><iframe width="560" height="315" src="https://www.youtube.com/embed/aUR_r8Oshes?autoplay=0&controls=1&loop=1&mute=1&playlist=aUR_r8Oshes" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><!--kg-card-end: html--><p></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="../content/images/2020/08/3dprint_shelf_clock.gif" class="kg-image"><figcaption>All the 42 edges and 24 triangles</figcaption></figure><hr><h3 id="the-electronics">The Electronics</h3><p></p><p>The electronics are fairly simple for this project. The main components use are -</p><ul><li>WS2812B</li><li>ESP32</li><li>Power Supply</li></ul><p>The reason this is so simple is thanks to the individually addressable LEDs WS2812b. Without these, an Edge of the shelf or a segment in the 7-seg display of the digit had to be wired to the controller separately. And since most of the controllers will not have these many I/O pins, something like multiplexing or shift register should be used. This would have greatly increased the wiring and circuitry.</p><p>WS2812b is well tested and has good libraries written to abstract dealing with the data signals and controlling these ICs. In this project we will be using <a href="http://fastled.io/">FastLED</a>.</p><p>ESP32 is again my favorite low power low cost microcontroller with inbuilt WiFi and Bluetooth capabilities. </p><p>Step 1 - Cutting the strip into smaller pieces<br>I could not stick the LEDs in single long strip as this would result in LEDs being present inbetween digit segments. So I measured the number of LEDs that would fit in each of the printed edge and cut the strip into pieces. 7 LEDs per segment in my case (with 60/m strip density).</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="../content/images/2020/08/IMG_20200802_163115.jpg" class="kg-image"><figcaption>Cutting strip for each Segment of the digit</figcaption></figure><p>Step 2 - Soldering the cut strips<br>The strips for each segment are soldered with small pieces of wire of length equal to the distance between two segments on the shelf. This was approx 1.5 cm for me.</p><figure class="kg-card kg-gallery-card kg-width-wide"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="../content/images/2020/08/IMG_20200802_195325.jpg" width="4608" height="3456"></div><div class="kg-gallery-image"><img src="../content/images/2020/08/IMG_20200802_195336.jpg" width="4608" height="3456"></div></div></div></figure><figure class="kg-card kg-gallery-card kg-width-wide"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="../content/images/2020/08/IMG_20200802_195818.jpg" width="4071" height="1895"></div><div class="kg-gallery-image"><img src="../content/images/2020/08/IMG_20200803_135635.jpg" width="4608" height="3456"></div></div></div></figure><p></p><p>Step 4 - Sticking the strip and final soldering and connections<br>The Strip is finally stuck to the shelf and all the individual segments are soldered. I have made a wiring diagram for how I have soldered the segments for reference. The controller is added and the power supply connections are made.</p><p></p><figure class="kg-card kg-gallery-card kg-width-wide"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="../content/images/2020/08/IMG_20200803_125632.jpg" width="4608" height="3456"></div><div class="kg-gallery-image"><img src="../content/images/2020/08/IMG_20200803_094135.jpg" width="4608" height="3456"></div></div></div></figure><p></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="../content/images/2020/08/shelf_clock_wiring_v2.svg" class="kg-image"><figcaption>Wiring Schematic for my clock&nbsp;</figcaption></figure><hr><h3 id="code">Code</h3><p></p><p>I am using this amazing code written by <a href="https://github.com/florianL21">florianL21</a>, checkout his repos for the shelf clock code. I have borrowed his code and modified it to work with my wiring schematic and my OTA update library.</p><p>In a very brief explanation, this is what the program does.<br>The controller is connected to the internet (via wifi). Since there is no RTC or timekeeping systems on board, everytime the board is started, it will ping <a href="https://www.ntppool.org/en/">NTP </a> and fetch the correct time. Internal clocks on ESP can be used to update the time from this starting point, but periodically ESP will fetch time from the NTP servers to account for any drifts in the time (due to inaccuracies in internal clock).  Next is taking care of display and setting the LEDs according to the time.<br>Since the LEDs used are RGB, any color can be set to the digits. And the ESP works with blynk to provide this capability, so that the user can change colors and adjust brightness anytime from smartphone.<br>I plan on adding other functionalities like integrating google assistant to show time by asking country wise, add a snake game and more.</p><hr><h3 id="testing-connections-and-first-run">Testing connections and first run</h3><p></p><figure class="kg-card kg-image-card"><img src="../content/images/2020/08/led_first_test_optimized.gif" class="kg-image"></figure><p></p><h3 id="done">Done</h3><p></p><!--kg-card-begin: html--><div class="tenor-gif-embed" data-postid="18050147" data-share-method="host" data-width="100%" data-aspect-ratio="1.7785714285714287"></div><script type="text/javascript" async src="https://tenor.com/embed.js"></script><!--kg-card-end: html--><hr><!--kg-card-begin: markdown--><p style="text-align: center;">**** इति लेखः समाप्तम् ****</p><!--kg-card-end: markdown-->
            </section>
        </article>
    </main>


    <footer class="footer animated fadeIn" id="footer">
        <section class="bottom">
    <section class="attribution">
        <a href="https://github.com/rakshithbk"> Rakshith BK | Personal Blog, Made with <i class="heart"></i></a>.
    </section>
</section>
    </footer>
    
    <script type="text/javascript" src="/assets/js/Saga.js" ></script>
</body>
</html>